define("priority_queue",["require"],function(e){var t=function(e,t){return t.priority-e.priority},n=function(e,t){return e.priority-t.priority};return function(e){var r=[],i=!1,s;e&&e.low?s=t:s=n;var o=function(){r.sort(s),i=!0},u={pop:function(){i||o();var e=r.pop();return e?e.object:void 0},top:function(){i||o();var e=r[r.length-1];return e?e.object:void 0},includes:function(e){for(var t=r.length-1;t>=0;t--)if(r[t].object===e)return!0;return!1},size:function(){return r.length},empty:function(){return r.length===0},push:function(e,t){r.push({object:e,priority:t}),i=!1},each:function(e){i||o();var t;for(t in r)r.hasOwnProperty(t)&&e(r[t].object)}};return u}}),define("dispatcher",["require","priority_queue"],function(e,t){return function(e){var n={},r=e||function(){return new t({low:!0})},i={connect:function(e,t,s){return s===undefined&&(s=100),n.hasOwnProperty(e)||(n[e]=r()),n[e].push(t,s),i},notify:function(e,t){return t.markUnprocessed().startPropagation().setDispatcher(i).setName(e),i.iterate(e,t,function(e){if(t.isPropagationStopped())return;e(t)})},iterate:function(e,t,r){return n.hasOwnProperty(e)?(n[e].each(r),t):t}};return i}}),define("event",["require"],function(e){return function(e,t){var n=t||{},r,i=void 0,s=void 0,o=!1,u=!0,a={getSubject:function(){return e},setDispatcher:function(e){return s=e,a},getDispatcher:function(){return s},setName:function(e){return i=e,a},getName:function(){return i},setReturnValue:function(e){return r=e,a},getReturnValue:function(){return r},isPropagationStopped:function(){return!u},stopPropagation:function(){return u=!1,a},startPropagation:function(){return u=!0,a},isProcessed:function(){return o},markProcessed:function(){return o=!0,a},markUnprocessed:function(){return o=!1,a},parameters:function(){return n},parameter:function(e){return n.hasOwnProperty(e)?n[e]:void 0}};return a}}),define("listener",["require"],function(e){return function(){var e=this;this.register=function(t){var n,r;for(n in e.mapping())3===n.length?r=n[2]:r=void 0,t.connect(n[0],n[1],r)},this.mapping=function(){throw"Listener.mapping is not implemented"}}}),define("main",["./dispatcher","./event","./listener"],function(e,t,n){return{dispatcher:e,event:t,listener:n}});